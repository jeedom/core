/*! Widget: filter jQuery UI formatter functions - updated 7/17/2014 (v2.17.5) */
!function(e){"use strict";var a=e.tablesorter||{},t=".compare-select",n=a.filterFormatter=e.extend({},a.filterFormatter,{addCompare:function(a,n,d){if(d.compare&&e.isArray(d.compare)&&d.compare.length>1){var i="",l=[t.slice(1)," "+t.slice(1),""],r=d.cellText?'<label class="'+l.join("-label")+n+'">'+d.cellText+"</label>":"";e.each(d.compare,function(e,a){i+="<option "+(d.selected===e?"selected":"")+">"+a+"</option>"}),a.wrapInner('<div class="'+l.join("-wrapper")+n+'" />').prepend(r+'<select class="'+l.join("")+n+'" />').find("select").append(i)}},updateCompare:function(a,n,d){var i=n.val()||"",l=i.replace(/\s*?[><=]\s*?/g,""),r=i.match(/[><=]/g)||"";return d.compare&&(e.isArray(d.compare)&&(r=(r||[]).join("")||d.compare[d.selected||0]),a.find(t).val(r)),[i,l]},uiSpinner:function(d,i,l){var r=e.extend({delayed:!0,addToggle:!0,exactMatch:!0,value:1,cellText:"",compare:"",min:0,max:100,step:1,disabled:!1},l),o=d.closest("table")[0].config,s=e('<input class="filter" type="hidden">').appendTo(d).bind("change"+o.namespace+"filter",function(){p({value:this.value,delayed:!1})}),c=[],p=function(n,i){var l,s=!0,p=n&&n.value&&a.formatFloat((n.value+"").replace(/[><=]/g,""))||d.find(".spinner").val()||r.value,f=(e.isArray(r.compare)?d.find(t).val()||r.compare[r.selected||0]:r.compare)||"",u=n&&"boolean"==typeof n.delayed?n.delayed:!o.$table[0].hasInitialized||(r.delayed||"");r.addToggle&&(s=d.find(".toggle").is(":checked")),l=r.disabled||!s?"disable":"enable",a.isEmptyObject(d.find(".spinner").data())||(d.find(".filter").val(s?(f||(r.exactMatch?"=":""))+p:"").trigger(i?"":"search",u).end().find(".spinner").spinner(l).val(p),c.length&&(c.find(".spinner").spinner(l).val(p).end().find(t).val(f),r.addToggle&&(c.find(".toggle")[0].checked=s)))};return r.oldcreate=r.create,r.oldspin=r.spin,r.create=function(e,a){p(),"function"==typeof r.oldcreate&&r.oldcreate(e,a)},r.spin=function(e,a){p(a),"function"==typeof r.oldspin&&r.oldspin(e,a)},r.addToggle&&e('<div class="button"><input id="uispinnerbutton'+i+'" type="checkbox" class="toggle" /><label for="uispinnerbutton'+i+'"></label></div>').appendTo(d).find(".toggle").bind("change",function(){p()}),d.closest("thead").find("th[data-column="+i+"]").addClass("filter-parsed"),e('<input class="spinner spinner'+i+'" />').val(r.value).appendTo(d).spinner(r).bind("change keyup",function(){p()}),o.$table.bind("filterFomatterUpdate"+o.namespace+"filter",function(){var e=n.updateCompare(d,s,r)[0];d.find(".spinner").val(e),p({value:e},!0),a.filter.formatterUpdated(d,i)}),r.compare&&(n.addCompare(d,i,r),d.find(t).bind("change",function(){p()})),o.$table.bind("stickyHeadersInit"+o.namespace+"filter",function(){c=o.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(i).empty(),r.addToggle&&e('<div class="button"><input id="stickyuispinnerbutton'+i+'" type="checkbox" class="toggle" /><label for="stickyuispinnerbutton'+i+'"></label></div>').appendTo(c).find(".toggle").bind("change",function(){d.find(".toggle")[0].checked=this.checked,p()}),e('<input class="spinner spinner'+i+'" />').val(r.value).appendTo(c).spinner(r).bind("change keyup",function(){d.find(".spinner").val(this.value),p()}),r.compare&&(n.addCompare(c,i,r),c.find(t).bind("change",function(){d.find(t).val(e(this).val()),p()}))}),o.$table.bind("filterReset"+o.namespace+"filter",function(){e.isArray(r.compare)&&d.add(c).find(t).val(r.compare[r.selected||0]),r.addToggle&&(d.find(".toggle")[0].checked=!1),d.find(".spinner").spinner("value",r.value),setTimeout(function(){p()},0)}),p(),s},uiSlider:function(d,i,l){var r=e.extend({delayed:!0,valueToHeader:!1,exactMatch:!0,cellText:"",compare:"",allText:"all",value:0,min:0,max:100,step:1,range:"min"},l),o=d.closest("table")[0].config,s=e('<input class="filter" type="hidden">').appendTo(d).bind("change"+o.namespace+"filter",function(){p({value:this.value})}),c=[],p=function(n,l){var s=void 0!==n?a.formatFloat((n.value+"").replace(/[><=]/g,""))||r.value:r.value,p=r.compare?s:s===r.min?r.allText:s,f=(e.isArray(r.compare)?d.find(t).val()||r.compare[r.selected||0]:r.compare)||"",u=f+p,m=n&&"boolean"==typeof n.delayed?n.delayed:!o.$table[0].hasInitialized||(r.delayed||"");r.valueToHeader?d.closest("thead").find("th[data-column="+i+"]").find(".curvalue").html(" ("+u+")"):d.find(".ui-slider-handle").addClass("value-popup").attr("data-value",u),a.isEmptyObject(d.find(".slider").data())||(d.find(".filter").val(f?f+s:s===r.min?"":(r.exactMatch?"=":"")+s).trigger(l?"":"search",m).end().find(".slider").slider("value",s),c.length&&(c.find(t).val(f).end().find(".slider").slider("value",s),r.valueToHeader?c.closest("thead").find("th[data-column="+i+"]").find(".curvalue").html(" ("+u+")"):c.find(".ui-slider-handle").addClass("value-popup").attr("data-value",u)))};return d.closest("thead").find("th[data-column="+i+"]").addClass("filter-parsed"),r.valueToHeader&&d.closest("thead").find("th[data-column="+i+"]").find(".tablesorter-header-inner").append('<span class="curvalue" />'),r.oldcreate=r.create,r.oldslide=r.slide,r.create=function(e,a){p(),"function"==typeof r.oldcreate&&r.oldcreate(e,a)},r.slide=function(e,a){p(a),"function"==typeof r.oldslide&&r.oldslide(e,a)},e('<div class="slider slider'+i+'"/>').appendTo(d).slider(r),o.$table.bind("filterFomatterUpdate"+o.namespace+"filter",function(){var e=n.updateCompare(d,s,r)[0];d.find(".slider").slider("value",e),p({value:e},!1),a.filter.formatterUpdated(d,i)}),r.compare&&(n.addCompare(d,i,r),d.find(t).bind("change",function(){p({value:d.find(".slider").slider("value")})})),o.$table.bind("filterReset"+o.namespace+"filter",function(){e.isArray(r.compare)&&d.add(c).find(t).val(r.compare[r.selected||0]),setTimeout(function(){p({value:r.value})},0)}),o.$table.bind("stickyHeadersInit"+o.namespace+"filter",function(){c=o.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(i).empty(),e('<div class="slider slider'+i+'"/>').val(r.value).appendTo(c).slider(r).bind("change keyup",function(){d.find(".slider").slider("value",this.value),p()}),r.compare&&(n.addCompare(c,i,r),c.find(t).bind("change",function(){d.find(t).val(e(this).val()),p()}))}),s},uiRange:function(t,n,d){var i=e.extend({delayed:!0,valueToHeader:!1,values:[0,100],min:0,max:100,range:!0},d),l=t.closest("table")[0].config,r=e('<input class="filter" type="hidden">').appendTo(t).bind("change"+l.namespace+"filter",function(){s()}),o=[],s=function(){var e=r.val(),a=e.split(" - ");""===e&&(a=[i.min,i.max]),a&&a[1]&&c({values:a,delay:!1},!0)},c=function(e,d){var r=e&&e.values||i.values,s=r[0]+" - "+r[1],c=r[0]===i.min&&r[1]===i.max?"":s,p=e&&"boolean"==typeof e.delayed?e.delayed:!l.$table[0].hasInitialized||(i.delayed||"");i.valueToHeader?t.closest("thead").find("th[data-column="+n+"]").find(".currange").html(" ("+s+")"):t.find(".ui-slider-handle").addClass("value-popup").eq(0).attr("data-value",r[0]).end().eq(1).attr("data-value",r[1]),a.isEmptyObject(t.find(".range").data())||(t.find(".filter").val(c).trigger(d?"":"search",p).end().find(".range").slider("values",r),o.length&&(o.find(".range").slider("values",r),i.valueToHeader?o.closest("thead").find("th[data-column="+n+"]").find(".currange").html(" ("+s+")"):o.find(".ui-slider-handle").addClass("value-popup").eq(0).attr("data-value",r[0]).end().eq(1).attr("data-value",r[1])))};return t.closest("thead").find("th[data-column="+n+"]").addClass("filter-parsed"),i.valueToHeader&&t.closest("thead").find("th[data-column="+n+"]").find(".tablesorter-header-inner").append('<span class="currange"/>'),i.oldcreate=i.create,i.oldslide=i.slide,i.create=function(e,a){c(),"function"==typeof i.oldcreate&&i.oldcreate(e,a)},i.slide=function(e,a){c(a),"function"==typeof i.oldslide&&i.oldslide(e,a)},e('<div class="range range'+n+'"/>').appendTo(t).slider(i),l.$table.bind("filterFomatterUpdate"+l.namespace+"filter",function(){s(),a.filter.formatterUpdated(t,n)}),l.$table.bind("filterReset"+l.namespace+"filter",function(){t.find(".range").slider("values",i.values),setTimeout(function(){c()},0)}),l.$table.bind("stickyHeadersInit"+l.namespace+"filter",function(){o=l.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(n).empty(),e('<div class="range range'+n+'"/>').val(i.value).appendTo(o).slider(i).bind("change keyup",function(){t.find(".range").val(this.value),c()})}),r},uiDateCompare:function(d,i,l){var r,o,s=e.extend({cellText:"",compare:"",endOfDay:!0,defaultDate:"",changeMonth:!0,changeYear:!0,numberOfMonths:1},l),c=d.closest("table")[0].config,p=d.closest("thead").find("th[data-column="+i+"]").addClass("filter-parsed"),f=e('<input class="dateCompare" type="hidden">').appendTo(d).bind("change"+c.namespace+"filter",function(){var e=this.value;e&&s.onClose(e)}),u=[],m=function(a){var n,i,l=r.datepicker("getDate")||"",o=(e.isArray(s.compare)?d.find(t).val()||s.compare[s.selected||0]:s.compare)||"",p=!c.$table[0].hasInitialized||(s.delayed||"");r.datepicker("setDate",(""===l?"":l)||null),""===l&&(a=!1),i=(n=r.datepicker("getDate"))?(s.endOfDay&&/<=/.test(o)?n.setHours(23,59,59,999):n.getTime())||"":"",n&&s.endOfDay&&"="===o&&(o="",i+=" - "+n.setHours(23,59,59,999),a=!1),d.find(".dateCompare").val(o+i).trigger(a?"":"search",p).end(),u.length&&u.find(".dateCompare").val(o+i).end().find(t).val(o)};return o='<input type="text" class="date date'+i+'" placeholder="'+(p.data("placeholder")||p.attr("data-placeholder")||c.widgetOptions.filter_placeholder.search||"")+'" />',r=e(o).appendTo(d),s.oldonClose=s.onClose,s.onClose=function(e,a){m(),"function"==typeof s.oldonClose&&s.oldonClose(e,a)},r.datepicker(s),c.$table.bind("filterReset"+c.namespace+"filter",function(){e.isArray(s.compare)&&d.add(u).find(t).val(s.compare[s.selected||0]),d.add(u).find(".date").val(s.defaultDate).datepicker("setDate",s.defaultDate||null),setTimeout(function(){m()},0)}),c.$table.bind("filterFomatterUpdate"+c.namespace+"filter",function(){var e,l=f.val();/\s+-\s+/.test(l)?(d.find(t).val("="),e=l.split(/\s+-\s+/)[0],r.datepicker("setDate",e||null)):e=""!==(e=n.updateCompare(d,f,s)[1].toString()||"")?/\d{5}/g.test(e)?new Date(Number(e)):e||"":"",d.add(u).find(".date").datepicker("setDate",e||null),setTimeout(function(){m(!0),a.filter.formatterUpdated(d,i)},0)}),s.compare&&(n.addCompare(d,i,s),d.find(t).bind("change",function(){m()})),c.$table.bind("stickyHeadersInit"+c.namespace+"filter",function(){(u=c.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(i).empty()).append(o).find(".date").datepicker(s),s.compare&&(n.addCompare(u,i,s),u.find(t).bind("change",function(){d.find(t).val(e(this).val()),m()}))}),f.val(s.defaultDate?s.defaultDate:"")},uiDatepicker:function(t,n,d){var i,l,r=e.extend({endOfDay:!0,textFrom:"from",textTo:"to",from:"",to:"",changeMonth:!0,changeYear:!0,numberOfMonths:1},d),o=[],s=t.closest("table")[0].config,c=function(e){return e instanceof Date&&isFinite(e)},p=e('<input class="dateRange" type="hidden">').appendTo(t).bind("change"+s.namespace+"filter",function(){var e=this.value;e.match(" - ")?(e=e.split(" - "),t.find(".dateTo").val(e[1]),l(e[0])):e.match(">=")?l(e.replace(">=","")):e.match("<=")&&l(e.replace("<=",""))}),f=t.closest("thead").find("th[data-column="+n+"]").addClass("filter-parsed");return i="<label>"+r.textFrom+'</label><input type="text" class="dateFrom" placeholder="'+(f.data("placeholderFrom")||f.attr("data-placeholder-from")||s.widgetOptions.filter_placeholder.from||"")+'" /><label>'+r.textTo+'</label><input type="text" class="dateTo" placeholder="'+(f.data("placeholderTo")||f.attr("data-placeholder-to")||s.widgetOptions.filter_placeholder.to||"")+'" />',e(i).appendTo(t),r.oldonClose=r.onClose,l=r.onClose=function(e,a){var n,d=t.find(".dateFrom").datepicker("getDate"),i=t.find(".dateTo").datepicker("getDate");d=c(d)?d.getTime():"",i=c(i)?(r.endOfDay?i.setHours(23,59,59,999):i.getTime())||"":"",n=d?i?d+" - "+i:">="+d:i?"<="+i:"",t.add(o).find(".dateRange").val(n).trigger("search"),d=d?new Date(d):"",i=i?new Date(i):"",/<=/.test(n)?t.add(o).find(".dateFrom").datepicker("option","maxDate",i||null).end().find(".dateTo").datepicker("option","minDate",null).datepicker("setDate",i||null):/>=/.test(n)?t.add(o).find(".dateFrom").datepicker("option","maxDate",null).datepicker("setDate",d||null).end().find(".dateTo").datepicker("option","minDate",d||null):t.add(o).find(".dateFrom").datepicker("option","maxDate",null).datepicker("setDate",d||null).end().find(".dateTo").datepicker("option","minDate",null).datepicker("setDate",i||null),"function"==typeof r.oldonClose&&r.oldonClose(e,a)},r.defaultDate=r.from||"",t.find(".dateFrom").datepicker(r),r.defaultDate=r.to||"+7d",t.find(".dateTo").datepicker(r),s.$table.bind("filterFomatterUpdate"+s.namespace+"filter",function(){var e=p.val()||"",d="",i="";/\s+-\s+/.test(e)?(d=(e=e.split(/\s+-\s+/)||[])[0]||"",i=e[1]||""):/>=/.test(e)?d=e.replace(/>=/,"")||"":/<=/.test(e)&&(i=e.replace(/<=/,"")||""),d=""!==d?/\d{5}/g.test(d)?new Date(Number(d)):d||"":"",i=""!==i?/\d{5}/g.test(i)?new Date(Number(i)):i||"":"",t.add(o).find(".dateFrom").datepicker("setDate",d||null),t.add(o).find(".dateTo").datepicker("setDate",i||null),setTimeout(function(){l(),a.filter.formatterUpdated(t,n)},0)}),s.$table.bind("stickyHeadersInit"+s.namespace+"filter",function(){(o=s.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(n).empty()).append(i),r.defaultDate=r.from||"",o.find(".dateFrom").datepicker(r),r.defaultDate=r.to||"+7d",o.find(".dateTo").datepicker(r)}),t.closest("table").bind("filterReset"+s.namespace+"filter",function(){t.add(o).find(".dateFrom").val("").datepicker("setDate",r.from||null),t.add(o).find(".dateTo").val("").datepicker("setDate",r.to||null),setTimeout(function(){l()},0)}),p.val(r.from?r.to?r.from+" - "+r.to:">="+r.from:r.to?"<="+r.to:"")}})}(jQuery);